DECLARE
V_ACTIVE_JOB VARCHAR2(200 BYTE);
BEGIN
SELECT JOBID INTO V_ACTIVE_JOB FROM TCGACDS.GCM_PROCESS_STATUS WHERE ACTIVEJOBID='Y';

UPDATE TCGACDS.GCM_PROCESS_STATUS SET ACTIVEJOBID='N' , SCIM_CONVERSION_STATUS='N' WHERE JOBID=V_ACTIVE_JOB;

UPDATE TCGACDS.GCM_PROCESS_STATUS SET ACTIVEJOBID='Y' WHERE JOBID =
(SELECT MAX(JOBID) FROM TCGACDS.GCM_PROCESS_STATUS WHERE SCIM_CONVERSION_STATUS='Y' AND JOBID <> V_ACTIVE_JOB);

DELETE FROM 	TCGACDS.GCM_SCIM_ACLINESEGMENT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_ACLINESEGMENTIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_ACLINESEGMENTOPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_ACTIVITYRECORD	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_ANALOG	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_ANALOGVALUE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_APPARENTPOWERLIMIT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_ASSETINFODETAIL	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BASEVOLTAGE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BREAKER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BREAKERASSET	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BREAKERASSETINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BREAKERIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BREAKEROPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BUSBARSECTION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BUSBARSECTIONASSET	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BUSBARSECTIONIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_BUSBARSECTIONOPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_CONFORMLOAD	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_CONFORMLOADGROUP	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_CONFORMLOADIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_CONNECTIVITYNODE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_CURVEDATA	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_DISCONNECTOR	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_DISCONNECTORIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_DISCRETE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_DISCRETEVALUE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_EQUIVALENTINJECTION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_FOSSILFUEL	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_GENERATINGUNIT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_GEOGRAPHICALREGION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_HYDROGENERATINGUNIT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_JUNCTION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_JUNCTIONIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEARSHUNTCOMPENSATOR	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEARSHUNTCOMPENSATORIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEREGULATOR	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEREGULATORASSET	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEREGULATORASSETINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEREGULATORIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LINEREGULATOROPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_LOADAREA	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_MEASUREMENTVALUESOURCE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_NONCONFORMLOAD	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_NONCONFORMLOADGROUP	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_NUCLEARGENERATINGUNIT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_OPERATIONALLIMITTYPE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_PHASETAPCHANGERLINEAR	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_POWERTRANSFORMER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_POWERTRANSFORMERASSET	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_POWERTRANSFORMERASSETINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_POWERTRANSFORMEREND	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_POWERTRANSFORMERIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_POWERTRANSFORMEROPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_PROTECTIONEQUIPMENT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_PROTECTIONEQUIPMENTIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_PROTECTIONEQUIPMENTOPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_PROTECTIONEQUIPMENTSTATUS	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_RATIOTAPCHANGER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_REACTIVECAPABILITYCURVE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_REGULATINGCONTROL	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_REGULATORBANK	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_RELATEDVALUE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SEASON	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SERIESCOMPENSATOR	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SERIESCOMPENSATORIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SERIESCOMPENSATOROPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SHORTCIRCUITDUTYINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SUBGEOGRAPHICALREGION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SUBLOADAREA	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SUBSTATION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SUBSTATIONIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SYNCHRONOUSMACHINE	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_SYNCHRONOUSMACHINEIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_TAPCHANGERCONTROL	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_TERMINAL	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_THERMALGENERATINGUNIT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_TRANSFORMERBANK	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_TRANSFORMERBANKIDENTIFIER	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_TRANSFORMERBANKOPINFO	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_VOLTAGELEVEL	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM 	TCGACDS.GCM_SCIM_VOLTAGELIMIT	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM     TCGACDS.GCM_SCIM_LOCATION	WHERE GCM_JOBID=V_ACTIVE_JOB;
DELETE FROM     TCGACDS.GCM_SCIM_CURRENTLIMIT	WHERE GCM_JOBID=V_ACTIVE_JOB;

DELETE FROM 	TCGACDS.GCM_SUB_I_CONN_SUBSTATIONS;

TCGACDS.GCM_PKG_SUB_I_CONN.GCM_P_INIT_SUB_I_CONN(V_ACTIVE_JOB);

END;